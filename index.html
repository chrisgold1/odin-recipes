<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odin Recipes</title>

    <body>
        <h1>Odin Recipes</h1>
        <ul>
        <li><a href ="./recipes/BraisedShortRibs.html" target="_blank">Braised Short Ribs</a></li>
        <li><a href ="./recipes/Braised-Brussels.html" target="_blank">Braised Brussels Sprouts</a></li>
        <li><a href ="./recipes/Glazed-Carrots.html" target="_blank">Glazed Carrots</a></li>
        </ul>

        <div style="background:#eee;border:1px solid #ccc;max-width:420px;width:100%;">
  <div style="background:#76c7c0;width:75%;height:18px;"></div>
</div>
<p><strong>Building Fund 2025:</strong> Raised $5,000 of $10,000 (50%) from 45 donors.</p>
<p style="font-size:.85rem;color:#666">Updated Aug 30, 2025</p>



<iframe width="290" height="376" seamless frameborder="0" scrolling="no" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTnZ7xw1kKw5nEQn9DjNCih7x576di0OHbUhcrDh665l0OrNkullqQVeRG2ELAu1XtnmktenWlygybI/pubchart?oid=1897499110&amp;format=interactive"></iframe>
    






<div id="thermo-wrap" style="max-width:360px;margin:0 auto;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;">
  <div id="goalLabel" style="text-align:center;font-weight:800;letter-spacing:.5px;margin-bottom:10px;">GOAL: $0</div>

  <svg id="thermo" viewBox="0 0 200 420" width="100%" height="auto" role="img" aria-label="Fundraising Thermometer">
    <defs>
      <clipPath id="tubeClip"><rect x="86" y="40" width="28" height="250" rx="14" ry="14"/></clipPath>
      <filter id="softShadow" x="-50%" y="-50%" width="200%" height="200%">
        <feDropShadow dx="0" dy="2" stdDeviation="2" flood-opacity="0.18"/>
      </filter>
    </defs>

    <g>
      <line x1="100" y1="40" x2="100" y2="300" stroke="#9aa4ad" stroke-width="2" stroke-linecap="round"/>
      <g id="ticks" stroke="#9aa4ad" stroke-width="2"></g>
    </g>

    <g filter="url(#softShadow)">
      <rect x="80" y="34" width="40" height="268" rx="20" ry="20" fill="#ffffff" stroke="#3f4b57" stroke-width="6"/>
      <circle cx="100" cy="340" r="46" fill="#ffffff" stroke="#3f4b57" stroke-width="6"/>
    </g>

    <g clip-path="url(#tubeClip)"><rect id="tubeFill" x="86" y="300" width="28" height="0" fill="#e74c3c"/></g>
    <circle id="bulbFill" cx="100" cy="340" r="40" fill="#e74c3c"/>

    <g id="callouts" font-size="12" fill="#fff" text-anchor="middle">
      <g id="pctBadge" transform="translate(60,220)">
        <rect x="-22" y="-12" rx="10" ry="10" width="44" height="24" fill="#3f4b57"></rect>
        <text id="pctText" y="5" font-weight="700">0%</text>
      </g>
      <g id="amtBadge" transform="translate(140,220)">
        <rect x="-36" y="-12" rx="10" ry="10" width="72" height="24" fill="#3f4b57"></rect>
        <text id="amtText" y="5" font-weight="700">$0</text>
      </g>
    </g>
  </svg>

  <style>
    @keyframes pulse { 0% { transform: scale(1) } 50% { transform: scale(1.04) } 100% { transform: scale(1) } }
  </style>

  <div style="text-align:center;color:#8a94a3;font-size:12px;margin-top:4px;">auto-refreshing from Google Sheets</div>
</div>

<script>
(function(){
  // === YOUR TIGHT-RANGE CSV URL (same file/gid/range, but CSV instead of HTML) ===
  const CSV_URL_BASE = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTnZ7xw1kKw5nEQn9DjNCih7x576di0OHbUhcrDh665l0OrNkullqQVeRG2ELAu1XtnmktenWlygybI/pub?gid=0&single=true&output=csv&range=G5:H6";

  const POLL_MS = 30000;   // check every 30s (use 60000+ in production)
  const DURATION_MS = 900; // animation duration

  const fmtMoney = n => {
    const sign = n < 0 ? "-" : "";
    const v = Math.abs(Number(n)||0);
    return sign + "$" + v.toLocaleString(undefined,{maximumFractionDigits:0});
  };
  const toNumber = s => Number(String(s||"").replace(/[^\d.\-]/g,"")) || 0;
  const easeOut = t => 1 - Math.pow(1-t,3);

  // draw ticks once
  (function drawTicks(){
    const g = document.querySelector("#ticks"); if (!g) return;
    for (let i=0;i<=10;i++){
      const y = 300 - i*(260/10);
      const len = (i%5===0)?12:7;
      const ln = document.createElementNS("http://www.w3.org/2000/svg","line");
      ln.setAttribute("x1",100-len); ln.setAttribute("x2",100+len);
      ln.setAttribute("y1",y); ln.setAttribute("y2",y);
      g.appendChild(ln);
    }
  })();

  // minimal CSV parser
  function parseCsv(t){
    const rows=[]; let row=[], cur="", q=false;
    for (let i=0;i<t.length;i++){
      const c=t[i], n=t[i+1];
      if (c === '"'){ q=!q; continue; }
      if (c === ',' && !q){ row.push(cur); cur=""; continue; }
      if ((c === '\n' || (c === '\r' && n !== '\n')) && !q){ row.push(cur); rows.push(row); row=[]; cur=""; continue; }
      cur += c;
    }
    if (cur.length || row.length){ row.push(cur); rows.push(row); }
    return rows;
  }

  // Expect a 2x2 range: row1 headers (Goal, Raised), row2 values
  function getGoalRaisedFromRange(rows){
    if (rows.length < 2) return {goal:0, raised:0};
    const headers = rows[0].map(h => (h||"").toString().trim().toLowerCase());
    const vals    = rows[1] || [];
    let goal=0, raised=0;
    headers.forEach((h,i)=>{
      if (h.includes("goal"))   goal   = toNumber(vals[i]);
      if (h.includes("raised")) raised = toNumber(vals[i]);
    });
    return {goal, raised};
  }

  let prevGoal = 0, prevRaised = 0;
  let lastRead = null;
  let pending  = null; // first read waiting for confirmation

  function animateTo(goal, raised){
    const startG=prevGoal, startR=prevRaised, t0 = performance.now(), tubeH=260;

    function frame(now){
      const t = Math.min(1, (now - t0)/DURATION_MS);
      const k = easeOut(t);
      const g = startG + (goal - startG)*k;
      const r = startR + (raised - startR)*k;
      const pct = g>0 ? Math.min(r/g,1) : 0;

      document.getElementById("goalLabel").textContent = "GOAL: " + fmtMoney(g);
      document.getElementById("pctText").textContent   = Math.round(pct*100) + "%";
      document.getElementById("amtText").textContent   = fmtMoney(r);

      const h = Math.round(tubeH*pct), y = 300 - h;
      const fill = document.getElementById("tubeFill");
      fill.setAttribute("y", y); fill.setAttribute("height", h);

      const yBadge = Math.max(60, Math.min(300 - h, 280));
      document.getElementById("pctBadge").setAttribute("transform", `translate(60, ${yBadge})`);
      document.getElementById("amtBadge").setAttribute("transform", `translate(140, ${yBadge})`);

      if (t<1) requestAnimationFrame(frame);
      else {
        prevGoal = goal; prevRaised = raised;
        const bulb = document.getElementById("bulbFill");
        bulb.style.animation = "pulse 600ms ease-out 1";
        setTimeout(()=> bulb.style.animation = "none", 700);
      }
    }
    requestAnimationFrame(frame);
  }

  function loadOnce(){
    const url = CSV_URL_BASE + (CSV_URL_BASE.includes("?") ? "&" : "?") + "t=" + Date.now(); // cache-bust
    fetch(url, {cache:"no-store"})
      .then(r => r.text())
      .then(text => {
        const rows = parseCsv(text);
        const {goal, raised} = getGoalRaisedFromRange(rows);
        if (!goal && !raised) return;

        const current = {goal:Number(goal)||0, raised:Number(raised)||0};

        // two-read stabilizer: require the same values twice in a row
        if (!pending || pending.goal !== current.goal || pending.raised !== current.raised) {
          pending = current;
          return; // wait for next poll to confirm
        }

        const changed = (current.goal !== prevGoal) || (current.raised !== prevRaised);
        if (!lastRead || changed) animateTo(current.goal, current.raised);
        lastRead = current;
      })
      .catch(() => {
        if (prevGoal === 0 && prevRaised === 0) animateTo(10000, 2500);
      });
  }

  loadOnce();
  setInterval(loadOnce, POLL_MS);
})();
</script>





</body>

    